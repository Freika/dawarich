<% if DawarichSettings.self_hosted? %>
  <!-- Supporter Section (separate card with its own form) -->
  <div class="card bg-base-200 shadow-xl">
    <div class="card-body">
      <h2 class="text-2xl font-bold mb-4 flex items-center">
        <%= icon 'heart', class: 'mr-2 text-pink-500' %> Supporter Status
      </h2>
      <div class="bg-base-100 p-5 rounded-lg shadow-sm space-y-4">
        <% if current_user.supporter? %>
          <div class="alert alert-success">
            <%= icon 'circle-check', class: 'w-5 h-5' %>
            <span>Thank you for supporting Dawarich<%= " via #{current_user.supporter_platform&.titleize}" if current_user.supporter_platform %>!</span>
          </div>
        <% end %>

        <%= form_with url: settings_verify_supporter_path, method: :post, data: { turbo: false } do |vf| %>
          <div class="form-control">
            <%= vf.label :supporter_email, class: 'label' do %>
              <span class="label-text font-medium">Email used for Patreon/GitHub/Ko-fi</span>
            <% end %>
            <div class="join w-full">
              <%= vf.email_field :supporter_email,
                  value: current_user.safe_settings.supporter_email,
                  class: 'input input-bordered join-item w-full',
                  placeholder: 'supporter@example.com' %>
              <%= vf.submit 'Verify', class: 'btn btn-primary join-item' %>
            </div>
          </div>
        <% end %>

        <% if current_user.safe_settings.supporter_email.present? && !current_user.supporter? %>
          <div class="alert">
            <%= icon 'triangle-alert', class: 'w-5 h-5 text-warning' %>
            <span>Email not found in supporter list. Make sure you're using the same email as your donation platform.</span>
          </div>
        <% end %>

        <!-- Info panel -->
        <div class="bg-base-200 p-4 rounded-lg space-y-3">
          <h3 class="font-semibold flex items-center gap-2">
            <%= icon 'info', class: 'w-4 h-4 text-primary' %> How to support Dawarich
          </h3>
          <p class="text-sm text-base-content/70">
            Dawarich is a free and open-source project. Your support helps cover hosting costs, fund development, and keep the project alive. You can support us through any of these platforms:
          </p>
          <div class="flex flex-wrap gap-2">
            <a href="https://www.patreon.com/freika" class="btn btn-sm btn-outline" target="_blank" rel="noopener noreferrer">
              Patreon
            </a>
            <a href="https://github.com/sponsors/Freika" class="btn btn-sm btn-outline" target="_blank" rel="noopener noreferrer">
              GitHub Sponsors
            </a>
            <a href="https://ko-fi.com/freika" class="btn btn-sm btn-outline" target="_blank" rel="noopener noreferrer">
              Ko-fi
            </a>
          </div>

          <h3 class="font-semibold mt-3">Supporter benefits</h3>
          <ul class="text-sm text-base-content/70 list-disc list-inside space-y-1">
            <li>Access to reverse geocoding API (see Patreon tier)</li>
            <li>Mention in Github Releases</li>
            <li>Supporter badge displayed in the navbar</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
<% end %>
